"use strict";angular.module("gotChamp").controller("MainCtrl",["$scope","localStorageService","$cookies","$cookieStore","$location","$route","authService","$interval","MainFactory","AccountStatusService","Test","LoadInfoDataFactory","LoadProfileFactory",function(n,t,i,r,u,f,e,o,s,h,c,l,a){var tt,v,y,p,it,b,w;n.mainInit=function(){var i,r;n.totalPrizesGivenAway=0;k();n.loadData();n.prevWinners=[];n.totalPrev=0;n.isDraw=!1;n.remaining={hours:0,Minutes:0,Seconds:0};i=t.get("authorizationData");typeof Storage!="undefined"&&sessionStorage.isAlreadyLogin==undefined&&t.clearAll();n.isLoggedIn;i==null?(n.hasCampaigns=!1,n.campaigns={},n.isLoggedIn=!1,g()):(n.latestCombination="0-0-0-0-0-0-0",n.monthly=0,n.weekends=0,n.hasWon=!0,n.hasData=!0,n.isLoggedIn=!0,nt(i.username));r=$.connection.myHub;r.client.newCountDownReceived=function(i){var r=JSON.parse(i);n.isDraw=r.IsDraw;$("#hours").text(r.hours);$("#minutes").text(r.Minutes);$("#seconds").text(r.Seconds);$("#hours2").text(r.hours);$("#minutes2").text(r.Minutes);$("#seconds2").text(r.Seconds);r.RemainingMinutes>=0&&r.RemainingSeconds>=0&&r.Minutes<=0&&r.hours<=0&&r.Seconds<=0&&($("#waiting").css({display:"block"}),$("#backMinutes").text(r.RemainingMinutes),$("#backSeconds").text(r.RemainingSeconds),t.clearAll())};$.connection.hub.start().done(function(){}).fail(function(n){console.error(n)});$("#prevWinners").carousel({pause:!0,interval:!1});$("#prevWinnersMob").carousel({pause:!0,interval:!1});n.index=0};var k=function(){l.getTotalPrizesGivenAway().success(function(t){n.totalPrizesGivenAway=t})},d=function(n,t){return n-t},g=function(){a.getCampaigns().success(function(t){t.length!=0&&(n.hasCampaigns=!0);n.campaigns=t})},nt=function(){a.getLatestCombination().success(function(t){if(t=="No records found yet."){n.hasData=!1;n.latestCombination="エントリーがありません。";return}n.latestCombination=t;n.latestCombination.breakDownedNumbers=n.latestCombination.Combination.split("-")});a.getStats().success(function(t){typeof t.timesPlayedthisMonth!="undefined"&&(n.monthly=t.timesPlayedthisMonth);typeof t.timesPlayedOnWeekend!="undefined"&&(n.weekends=t.timesPlayedOnWeekend);n.hasWon=typeof t.nonWinner==0?!1:!0})};for(n.calcIndex=function(t,i){var r=t+i;n.combiIndex=r},n.altIndex=function(t){n.index+=t;$(".winning-combination.item").removeClass("active");$(".winning-combination.item[index="+n.index+"]").addClass("active")},n.authData=t.get("authorizationData"),n.user={},v=0,y=3,n.user={},n.numbers=[],n.combinations=[],n.SuperCombinationPrize="0",n.cutOffReadable="12:00 pm",n.previousCombination=[],n.winningPrev=function(){y--;y==2?n.nextExp="two":y==1&&(n.nextExp="three",n.isMin=!0)},n.winningNext=function(){y++;y==2?(n.nextExp="two",n.isMin=!1):y>=3&&(n.nextExp="one",y=3)},e.fillAuthData(),n.authentication=e.authentication,n.displayedCombination=[],p=1;p<=49;p++)tt=p>9?""+p:"0"+p,n.numbers.push(p);for(l.getGlobalTime().then(function(n){setInterval(function(){var t=new Date(n.data)},1e3)}),n.checkPlayed=function(){var i=t.get("authorizationData");i&&((i.isPlayed+"").toLowerCase()=="true"?(n.isPlayed=!0,n.clearPicks()):n.isPlayed=!1)},n.UpdateCombination=function(){for(var t=0;t<7;t++)n.displayedCombination[t]=n.combinations[t]},n.loadCombination=function(){if(t.get("combinationNumberData")!=null){for(var i=0;i<7;i++)n.combinations.push(t.get("combinationNumberData")[i]);n.isSelected=function(t){return n.combinations.indexOf(t)>=0?!0:!1};v=7;n.UpdateCombination()}},n.user.combinationNumber="",n.play=function(){if(!n.isPlayed){if(v==0){toastr.warning("エントリーを選択して下さい。");return}if(v<7){toastr.warning("7つの番号を選択してください。");return}var i=t.get("authorizationData");t.set("combinationNumberData",n.combinations);i?v==7&&u.path("/content"):u.path("/login")}},n.Select=function(t){var r,i;if(!n.isPlayed){if(!(n.combinations.indexOf(t)<0)){n.Clear(n.combinations.indexOf(t));return}if(v<7){for(r=!1,i=0;i<7;i++)if(n.combinations[i]==null){n.combinations.splice(i,1,t);n.UpdateCombination();r=!0;break}r||n.combinations.push(t);v++;n.UpdateCombination()}n.isSelected=function(t){return n.combinations.indexOf(t)>=0?!0:!1}}},n.isLast=function(t){return n.displayedCombination[6]==t?!0:!1},n.Clear=function(t){n.combinations[t]!=null&&(n.combinations.splice(t,1,null),n.displayedCombination=[],v--,n.UpdateCombination())},n.clearPicks=function(){n.combinations=[];n.displayedCombination=[];n.user.combinationNumber="";t.remove("combinationNumberData");v=0;n.UpdateCombination()},n.quickPicks=function(){var i,t;for(n.combinations=[],i=0;i<7;i++){for(t=Math.floor(Math.random()*49+1);n.combinations.indexOf(t)>=0;)t=Math.floor(Math.random()*49+1);n.combinations.push(t)}n.isSelected=function(t){return n.combinations.indexOf(t)>=0?!0:!1};v=7;n.UpdateCombination()},n.Login=function(n){s.login(n,function(){},function(){})},b=function(i){var h=n.cutOff.getTime()-288e5-i.getTime()<0?n.cutOff.getTime()- -576e5-i.getTime():n.cutOff.getTime()-288e5-i.getTime(),r=new Date(h),u=r.getHours(),e=r.getMinutes(),s=r.getSeconds();n.remaining={Hours:u,Minutes:e,Seconds:s};u==0&&e==0&&s==0&&(o.cancel(it),n.waitingNewDraw=!0,t.clearAll(),f.reload())},n.displayedNumbers=[],n.combinationRows=[],w=0;w<7;w++)n.displayedNumbers.push(w),n.combinationRows.push(w);n.multiplier=function(n){return 7*n};n.calc=function(n,t){return 5-t};n.loadData=function(){try{l.loadTime().then(function(t){var f=t.data.CutOffDateTime.split("."),u=f[0].split("T"),i=u[0].split("-"),r=u[1].split(":");n.cutOff=new Date(parseInt(i[0]),parseInt(i[1]),parseInt(i[2]),parseInt(r[0]),parseInt(r[1]),parseInt(r[2]),0);n.cutOffReadable=(n.cutOff.getHours()>12?n.cutOff.getHours()-12:n.cutOff.getHours()==0?12:n.cutOff.getHours())+":"+((n.cutOff.getMinutes()+"").length>1?n.cutOff.getMinutes():"0"+n.cutOff.getMinutes())+" "+(n.cutOff.getHours()>=12?"pm":"am");try{l.getGlobalTime().then(function(t){if(t.data!=null){var f=t.data.CutoffTime.split("."),u=f[0].split("T"),i=u[0].split("-"),r=u[1].split(":");n.globalTime=new Date(parseInt(i[0]),parseInt(i[1]),parseInt(i[2]),parseInt(r[0]),parseInt(r[1]),parseInt(r[2]),0)}else n.waitingNewDraw=!0})}catch(e){}},function(){})}catch(t){}try{l.loadPrizes().then(function(t){t.data.length>0&&(n.SuperCombinationPrize=t.data[0].Amount)},function(){toastr.error("Failed to load Prizes Information.")})}catch(t){}try{l.loadWinningCombinations().then(function(t){var r,i;if(!(t.data.length<=0))for(r=[],r.push(t.data),r.reverse(),i=0;i<t.data.length;i++){var e=r[0][i].RaffleDrawDate.split("."),f=e[0].split("T"),c=f[0].split("-"),l=f[1].split(":"),o=t.data[i].RaffleDrawDate.split("T")[0],s=new Date(o),u=r[0][i].WinningCombination.split("-"),h=u.pop();u.sort(d);u.push(h);n.previousCombination.push({combination:u,date:s,gameNum:r[0][i].RaffleId});n.totalPrev+=1}},function(){})}catch(t){}try{l.loadPrevWinners().then(function(t){t.data.length>0&&(n.prevWinners=t.data)},function(){})}catch(t){}}}]).factory("MainFactory",["$resource",function(n){return n("api/account",{},{login:{method:"POST"}})}]).factory("AccountStatusService",["$http",function(n){var t={},i=function(t){return n.get("/api/Account/Status",t).then(function(n){return n})};return t.isPlayed=i,t}]).factory("Test",["$http",function(n){var t={},i=function(){return n.post("api/account/register").then(function(){})};return t.Regs=i,t}]).factory("LoadInfoDataFactory",["$http",function(n){return{loadTime:function(){return n.get("/api/general/loadTime")},loadPrizes:function(t){return n.get("/api/general/loadPrizes",t)},loadWinningCombinations:function(t){return n.get("/api/general/loadWinningCombinations",t)},getGlobalTime:function(){return n.get("api/globalTime")},loadPrevWinners:function(){return n.get("api/general/loadPrevWinners")},getTotalPrizesGivenAway:function(){return n.get("api/playerProfile/getTotalPrizesGivenAway")}}}]).factory("LoadProfileFactory",["$http",function(n){return{getCampaigns:function(){return n.get("/api/campaign/getAllPublishedCampaigns")},getLatestCombination:function(){return n.get("/api/combination/getPlayerCombination")},getStats:function(){return n.get("/api/general/loadWinnerStatus")}}}]).filter("slice",function(){return function(n,t,i){return n.slice(t,i)}});
//# sourceMappingURL=main.controller.min.js.map
